{"version":3,"file":"src_app_login_login_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;AAAyC;AACc;AAEd;AAEzC,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,kDAAS;KACrB;CACF,CAAC;IAMW,sBAAsB,SAAtB,sBAAsB;;AAAtB,sBAAsB;IAJlC,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,sBAAsB;AAAA;;;;;;;;;;;;;;;;;;;;;;;AChBM;AACM;AACmB;AAErB;AAEmB;AAEvB;IAY5B,eAAe,SAAf,eAAe;;AAAf,eAAe;IAV3B,uDAAQ,CAAC;QACR,OAAO,EAAE;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,yEAAsB;YACtB,+DAAmB;SACpB;QACD,YAAY,EAAE,CAAC,kDAAS,CAAC;KAC1B,CAAC;GACW,eAAe;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpB5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAOaU,SAAS,SAATA,SAAS;EAIrBC,YACSC,EADT,EAESC,eAFT,EAGSC,MAHT,EAISC,iBAJT,EAKWC,aALX,EAMQC,cANR,EAOWC,GAPX,EAQQC,SARR,EAQ4B;IAPnB;IACA;IACA;IACA;IACE;IACH;IACG;IACH;EACJ;;EAEJC,QAAQ;IACP,KAAKC,WAAL,GAAmB,KAAKT,EAAL,CAAQU,KAAR,CAAc;MAChCC,MAAM,EAAE,CAAC,EAAD,EAAK,CAACrB,+DAAD,CAAL,CADwB;MAEhCuB,QAAQ,EAAE,CAAC,EAAD,EAAK,CAACvB,+DAAD,CAAL;IAFsB,CAAd,CAAnB;IAIAwB,YAAY,CAACC,KAAb;EACA;;EAGKC,KAAK;IAAA;;IAAA;MACV,MAAMC,OAAO,SAAS,KAAI,CAACd,iBAAL,CAAuBe,MAAvB,EAAtB;MACA,MAAMD,OAAO,CAACE,OAAR,EAAN;;MAEA,KAAI,CAACf,aAAL,CAAmBY,KAAnB,CAAyB,KAAI,CAACP,WAAL,CAAiBW,KAA1C,EAAiDC,SAAjD;QAAA,yIACC,WAAOC,GAAP,EAAmB;UAClB,MAAML,OAAO,CAACM,OAAR,EAAN;UACIT,YAAY,CAACU,OAAb,CAAqB,MAArB,EAA6BC,IAAI,CAACC,SAAL,CAAeJ,GAAG,CAACK,IAAnB,CAA7B;;UACN,KAAI,CAACpB,SAAL,CAAeqB,QAAf,GACCC,IADD,CACMC,KAAK,IAAG;YACb,MAAMH,IAAI,GAAGF,IAAI,CAACM,KAAL,CAAWjB,YAAY,CAACkB,OAAb,CAAqB,MAArB,CAAX,CAAb;;YACC,KAAI,CAAC3B,cAAL,CAAoB4B,QAApB,CAA6B;cAACC,SAAS,EAAE,KAAI,CAACC,QAAjB;cAA2BC,SAAS,EAAEN,KAAtC;cAA6CO,WAAW,EAAEV,IAAI,CAAChB,MAA/D;cAAuE2B,OAAO,EAAEX,IAAI,CAACW;YAArF,CAA7B,EAA4HjB,SAA5H,CAAuIC,GAAD,IAAa,CAClJ,CADD;UAED,CALD,EAKG;UALH,CAMCiB,KAND,CAMOC,KAAK,IAAIC,OAAO,CAACD,KAAR,CAAc,qBAAd,EAAqCA,KAArC,CANhB;;UAQA,KAAI,CAACjC,SAAL,CAAemC,iBAAf,GACCrB,SADD,CACWsB,IAAI,IAAIF,OAAO,CAACG,GAAR,CAAY,8BAA8BD,IAAI,EAA9C,CADnB;;UAGA,KAAI,CAACpC,SAAL,CAAesC,cAAf,GACCxB,SADD,CACYS,KAAD,IAAmBW,OAAO,CAACG,GAAR,CAAY,mBAAmBd,KAAK,EAApC,CAD9B;;UAEA,MAAMH,IAAI,GAAGF,IAAI,CAACM,KAAL,CAAWjB,YAAY,CAACkB,OAAb,CAAqB,MAArB,CAAX,CAAb;;UACE,IAAGL,IAAI,IAAIA,IAAI,CAACW,OAAhB,EAAyB;YACxB,KAAI,CAACpC,MAAL,CAAY4C,aAAZ,CAA0B,OAA1B,EAAmC;cAAEC,UAAU,EAAE;YAAd,CAAnC;UAEA,CAHD,MAGO,IAAGpB,IAAI,IAAIA,IAAI,CAACqB,IAAhB,EAAsB;YAC5B,KAAI,CAAC9C,MAAL,CAAY4C,aAAZ,CAA0B,KAA1B,EAAgC;cAAEC,UAAU,EAAE;YAAd,CAAhC;UACA,CAFM,MAGF;YACJ,KAAI,CAAC7C,MAAL,CAAY4C,aAAZ,CAA0B,OAA1B,EAAmC;cAAEC,UAAU,EAAE;YAAd,CAAnC;UACA;QACD,CA3BF;;QAAA;UAAA;QAAA;MAAA;QAAA,0IA4BC,WAAOzB,GAAP,EAAc;UACb,MAAML,OAAO,CAACM,OAAR,EAAN;UACA,MAAM0B,KAAK,SAAS,KAAI,CAAChD,eAAL,CAAqBiB,MAArB,CAA4B;YAC/CgC,MAAM,EAAE,cADuC;YAE/CC,OAAO,EAAE7B,GAAG,CAACkB,KAAJ,CAAUA,KAF4B;YAG/CY,OAAO,EAAE,CAAC,IAAD;UAHsC,CAA5B,CAApB;UAMA,MAAMH,KAAK,CAAC9B,OAAN,EAAN;QACA,CArCF;;QAAA;UAAA;QAAA;MAAA;IAJU;EA2CV,CAnEoB,CAqErB;;;EACU,IAANR,MAAM;IACT,OAAO,KAAKF,WAAL,CAAiB4C,GAAjB,CAAqB,QAArB,CAAP;EACA;;EAEW,IAARxC,QAAQ;IACX,OAAO,KAAKJ,WAAL,CAAiB4C,GAAjB,CAAqB,UAArB,CAAP;EACA;;EAEDC,IAAI;IACHxC,YAAY,CAACU,OAAb,CAAqB,UAArB,EAAiC,OAAjC;IACA,KAAKtB,MAAL,CAAYqD,QAAZ,CAAqB,CAAC,QAAD,CAArB;EACA;;AAjFoB;;;;;;;;;;;;;;;;;;;;AAATzD,SAAS,uDALrBV,yDAAS,CAAC;EACVoE,QAAQ,EAAE,WADA;EAEVC,UAAAA,wDAFU;;AAAA,CAAD,CAKY,GAAT3D,SAAS,CAAT","sources":["./src/app/login/login-routing.module.ts","./src/app/login/login.module.ts","./src/app/login/login.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule,\r\n    ReactiveFormsModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\nimport { Router } from '@angular/router';\r\nimport { CommonService } from '../common.service';\r\nimport { CommonServiceService } from '../common-service.service';\r\nimport { FCM } from '@awesome-cordova-plugins/fcm/ngx';\r\nimport { FirebaseX } from '@awesome-cordova-plugins/firebase-x/ngx';\r\n\r\n@Component({\r\n\tselector: 'app-login',\r\n\ttemplateUrl: './login.page.html',\r\n\tstyleUrls: ['./login.page.scss']\r\n})\r\nexport class LoginPage implements OnInit {\r\n\tcredentials!: FormGroup;\r\n\tuniqueId: any;\r\n\r\n\tconstructor(\r\n\t\tprivate fb: FormBuilder,\r\n\t\tprivate alertController: AlertController,\r\n\t\tprivate router: Router,\r\n\t\tprivate loadingController: LoadingController,\r\n    private commonService: CommonService,\r\n\tprivate commonServices: CommonServiceService,\r\n    private fcm: FCM,\r\n\tprivate firebaseX: FirebaseX, \r\n\t) {}\r\n\r\n\tngOnInit() {\r\n\t\tthis.credentials = this.fb.group({\r\n\t\t\tmobile: ['', [Validators.required]],\r\n\t\t\tpassword: ['', [Validators.required]]\r\n\t\t});\r\n\t\tlocalStorage.clear();\r\n\t}\r\n\r\n\t\r\n\tasync login() {\r\n\t\tconst loading = await this.loadingController.create();\r\n\t\tawait loading.present();\r\n\r\n\t\tthis.commonService.login(this.credentials.value).subscribe(\r\n\t\t\tasync (res: any) => {\r\n\t\t\t\tawait loading.dismiss();\r\n        localStorage.setItem('user', JSON.stringify(res.user))\r\n\t\tthis.firebaseX.getToken()\r\n\t\t.then(token => {\r\n\t\t\tconst user = JSON.parse(localStorage.getItem('user'))\r\n\t\t  this.commonServices.addToken({device_id: this.uniqueId, fcm_token: token, phoneNumber: user.mobile, isAdmin: user.isAdmin}).subscribe((res: any) => {\r\n\t\t  })\r\n\t\t}) // save the token server-side and use it to push notifications to this device\r\n\t\t.catch(error => console.error('Error getting token', error));\r\n\t\r\n\t\tthis.firebaseX.onMessageReceived()\r\n\t\t.subscribe(data => console.log(`User opened a notification ${data}`));\r\n\t\r\n\t\tthis.firebaseX.onTokenRefresh()\r\n\t\t.subscribe((token: string) => console.log(`Got a new token ${token}`));\r\n\t\tconst user = JSON.parse(localStorage.getItem('user'))\r\n\t\t\t\tif(user && user.isAdmin) {\r\n\t\t\t\t\tthis.router.navigateByUrl('/tabs', { replaceUrl: true });\r\n\r\n\t\t\t\t} else if(user && user.isDj) {\r\n\t\t\t\t\tthis.router.navigateByUrl('/dj',{ replaceUrl: true})\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.router.navigateByUrl('/home', { replaceUrl: true });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync (res) => {\r\n\t\t\t\tawait loading.dismiss();\r\n\t\t\t\tconst alert = await this.alertController.create({\r\n\t\t\t\t\theader: 'Login failed',\r\n\t\t\t\t\tmessage: res.error.error,\r\n\t\t\t\t\tbuttons: ['OK']\r\n\t\t\t\t});\r\n\r\n\t\t\t\tawait alert.present();\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t// Easy access for form fields\r\n\tget mobile() {\r\n\t\treturn this.credentials.get('mobile');\r\n\t}\r\n\r\n\tget password() {\r\n\t\treturn this.credentials.get('password');\r\n\t}\r\n\r\n\tskip() {\r\n\t\tlocalStorage.setItem('userType', 'guest')\r\n\t\tthis.router.navigate(['/media'])\r\n\t}\r\n}"],"names":["Component","FormBuilder","Validators","AlertController","LoadingController","Router","CommonService","CommonServiceService","FCM","FirebaseX","LoginPage","constructor","fb","alertController","router","loadingController","commonService","commonServices","fcm","firebaseX","ngOnInit","credentials","group","mobile","required","password","localStorage","clear","login","loading","create","present","value","subscribe","res","dismiss","setItem","JSON","stringify","user","getToken","then","token","parse","getItem","addToken","device_id","uniqueId","fcm_token","phoneNumber","isAdmin","catch","error","console","onMessageReceived","data","log","onTokenRefresh","navigateByUrl","replaceUrl","isDj","alert","header","message","buttons","get","skip","navigate","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}